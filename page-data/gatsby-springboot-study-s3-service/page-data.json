{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/gatsby-springboot-study-s3-service/",
    "result": {"data":{"cur":{"id":"d6f03a9a-7980-5414-b80e-0d7391d1dcb1","html":"<h2 id=\"-ê°œìš”\" style=\"position:relative;\"><a href=\"#-%EA%B0%9C%EC%9A%94\" aria-label=\" ê°œìš” permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‘€ ê°œìš”</h2>\n<p>ì´ì „ í¬ìŠ¤íŒ… ì—ì„œ S3ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ë‹¤ë¤˜ì—ˆë‹¤.</p>\n<p>ìš”ë²ˆì—ëŠ” S3ì— íŒŒì¼ì„ ì—…ë¡œë“œí•˜ëŠ” ê³¼ì •ì„ í¬ìŠ¤íŒ… í•˜ë ¤í•œë‹¤.</p>\n<blockquote>\n<p>â— S3ì— ëŒ€í•´ì„œëŠ” ì´ì „ í¬ìŠ¤íŒ… ì°¸ê³  <a href=\"https://leesungki.github.io/gatsby-aws-study-s3/\">S3ë€?</a></p>\n</blockquote>\n<blockquote>\n<p>ğŸ¦º S3 ë²„í‚· ìƒì„±ì— ëŒ€í•´ì„œëŠ” ì´ì „ í¬ìŠ¤íŒ… ì°¸ê³  <a href=\"https://leesungki.github.io/gatsby-aws-study-s3/\">S3 ë²„í‚· ìƒì„±</a></p>\n</blockquote>\n<h2 id=\"-s3-íŒŒì¼-ì—…ë¡œë“œ\" style=\"position:relative;\"><a href=\"#-s3-%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C\" aria-label=\" s3 íŒŒì¼ ì—…ë¡œë“œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ—‘ S3 íŒŒì¼ ì—…ë¡œë“œ</h2>\n<ol>\n<li>ë²„í‚· ìƒì„±</li>\n</ol>\n<p>ì¼ë‹¨ ë‚˜ëŠ” ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ file-upload-test-lee ë¼ëŠ” ëª…ì¹­ìœ¼ë¡œ í¼ë¸”ë¦­í•œ ë²„í‚·ì„ í•˜ë‚˜ ìƒì„±í–ˆë‹¤.\r\n<img src=\"/91144b0038b8571eb5bb57e1d78b64ea/springboots3.png\" alt=\"springboots3.PNG\"></p>\n<p>í•´ë‹¹ ë²„í‚·ì„ í´ë¦­í•˜ì—¬ ë“¤ì–´ê°€ë©´ ì•„ë¬´ëŸ° ê°ì²´ë„ ì—†ëŠ” ìƒíƒœì´ë‹¤.\r\n<img src=\"/5e4d4a4ec6b71456c81895fe10675c62/springboots31.png\" alt=\"springboots31.PNG\"></p>\n<p>ê·¸ë¦¬ê³  iam ê¶Œí•œì— ì‚¬ìš©ìì—ê²Œ S3FullAccess ê¶Œí•œì„ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (ì´ê²ƒì´ ìˆì–´ì•¼ S3ì— íŒŒì¼ ì—…ë¡œë“œë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.)</p>\n<p>ì¼ë‹¨ aws ìƒì—ì„œì˜ ì‘ì—…ì€ ì´ì •ë„ë§Œ í•´ì£¼ë©´ëœë‹¤.</p>\n<p>ì´ì œ ì‹¤ì œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì—ì„œ aws s3 ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•´ ë³´ì.</p>\n<ol start=\"2\">\n<li>AmazonS3ClientBuilder ë¥¼ ì‚¬ìš©í•œ ì—…ë¡œë“œ êµ¬í˜„</li>\n</ol>\n<p>ì˜ì¡´ì„± ì¶”ê°€</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">implementation group: 'org.springframework.cloud', name: 'spring-cloud-starter-aws', version: '2.2.5.RELEASE'</code></pre></div>\n<p>í”„ë¡œì íŠ¸ êµ¬ì¡°</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">common\r\n    ã„´config\r\n        ã„´AmazonS3Config\r\ncontroller\r\n    ã„´CheckController\r\naws\r\n    ã„´AwsSecret\r\n    ã„´SecretManagerBuild\r\nservice\r\n    ã„´S3Service   \r\nresources\r\n    ã„´application.yml\r\n    ã„´static.image.test\r\n        ã„´mey.jpg      </code></pre></div>\n<ul>\n<li>AmazonS3Config</li>\n<li>CheckController</li>\n<li>AwsSecret</li>\n<li>SecretManagerBuild</li>\n<li>S3Service</li>\n<li>application</li>\n<li>mey.jpg: ë¡œì»¬ í…ŒìŠ¤íŠ¸ìš© ì´ë¯¸ì§€íŒŒì¼ì„ ë„£ì–´ì¤¬ë‹¤.</li>\n</ul>\n<p>ë¨¼ì € ë‚˜ëŠ” s3ì— ì ‘ê·¼í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ secretmanagerë¥¼ í†µí•´ ë°›ì•„ì˜¬ê²ƒì´ê¸° ë•Œë¬¸ì— ìœ„ì™€ ê°™ì´ êµ¬ì¡°ë¥¼ ë§Œë“¤ì–´ ì£¼ì—ˆë‹¤.</p>\n<p>í•´ë‹¹ ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” ì´ì „ í¬ìŠ¤íŒ…ì„ ì°¸ê³  í•˜ì.</p>\n<p><a href=\"https://leesungki.github.io/gatsby-springboot-study-secretsManager/\">ì°¸ê³ </a></p>\n<p>application.yml</p>\n<div class=\"gatsby-highlight\" data-language=\"yml\"><pre class=\"language-yml\"><code class=\"language-yml\"><span class=\"token key atrule\">secret</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token comment\">#_dev arn</span>\r\n    <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> <span class=\"token comment\">#ì‹œí¬ë¦¿ ë§¤ë‹ˆì € arn</span>\r\n    <span class=\"token key atrule\">crawler</span><span class=\"token punctuation\">:</span> <span class=\"token comment\">#ì‹œí¬ë¦¿ ë§¤ë‹ˆì € arn</span>\r\n    <span class=\"token key atrule\">ecm</span><span class=\"token punctuation\">:</span> <span class=\"token comment\">#ì‹œí¬ë¦¿ ë§¤ë‹ˆì € arn</span>\r\n<span class=\"token key atrule\">cloud</span><span class=\"token punctuation\">:</span>\r\n  <span class=\"token key atrule\">aws</span><span class=\"token punctuation\">:</span>\r\n    <span class=\"token key atrule\">region</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">static</span><span class=\"token punctuation\">:</span> ap<span class=\"token punctuation\">-</span>northeast<span class=\"token punctuation\">-</span><span class=\"token number\">2</span>\r\n    <span class=\"token key atrule\">stack</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">auto</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span>\r\n    <span class=\"token key atrule\">s3</span><span class=\"token punctuation\">:</span>\r\n      <span class=\"token key atrule\">bucket</span><span class=\"token punctuation\">:</span> file<span class=\"token punctuation\">-</span>upload<span class=\"token punctuation\">-</span>test<span class=\"token punctuation\">-</span>lee</code></pre></div>\n<p>application.yml ì— aws ê´€ë ¨ ì •ë³´ë¥¼ ê¸°ì¬í•´ ì¤€ë‹¤.</p>\n<p>AmazonS3Config</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Slf4j</span>\r\n<span class=\"token annotation punctuation\">@Configuration</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">AmazonS3Config</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">/**\r\n     * aws ê°€ìš© ì§€ì—­\r\n     */</span>\r\n    <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${cloud.aws.region.static}\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> region<span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">/**\r\n     * secretmanager key arn\r\n     */</span>\r\n    <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${secret.name.key}\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> secretName<span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">/**\r\n     * s3 ì ‘ê·¼ì„ ìœ„í•œ ìœ„í•œ ì‚¬ìš©ì bean\r\n     */</span>\r\n    <span class=\"token annotation punctuation\">@Bean</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">AmazonS3Client</span> <span class=\"token function\">amazonS3Client</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"------------------------------------->AmazonS3Client\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">AwsSecret</span> secretKeys <span class=\"token operator\">=</span> <span class=\"token class-name\">SecretManagerBuild</span><span class=\"token punctuation\">.</span><span class=\"token function\">getSecret</span><span class=\"token punctuation\">(</span>secretName<span class=\"token punctuation\">,</span>region<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">String</span> accessKey <span class=\"token operator\">=</span> secretKeys<span class=\"token punctuation\">.</span><span class=\"token function\">getAws_ac_key</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">String</span> secretKey <span class=\"token operator\">=</span> secretKeys<span class=\"token punctuation\">.</span><span class=\"token function\">getAws_se_key</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token class-name\">BasicAWSCredentials</span> awsCreds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BasicAWSCredentials</span><span class=\"token punctuation\">(</span>accessKey<span class=\"token punctuation\">,</span> secretKey<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">AmazonS3Client</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">AmazonS3ClientBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">standard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">withRegion</span><span class=\"token punctuation\">(</span>region<span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">withCredentials</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">AWSStaticCredentialsProvider</span><span class=\"token punctuation\">(</span>awsCreds<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>AmazonS3ClientBuilder ë¥¼í†µí•´ ì ‘ê·¼ ì •ë³´ë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.</p>\n<p>S3Service</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Slf4j</span>\r\n<span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\r\n<span class=\"token annotation punctuation\">@Component</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">S3Service</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token comment\">/**\r\n     * s3 ì ‘ê·¼ ì •ë³´\r\n     */</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">AmazonS3Client</span> amazonS3Client<span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">/**\r\n     * S3 ë²„í‚· ëª…\r\n     */</span>\r\n    <span class=\"token annotation punctuation\">@Value</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"${cloud.aws.s3.bucket}\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> bucket<span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">/**\r\n     * ê°ì²´ urlì„ ì½ì–´ì˜¨ë‹¤\r\n     * @param {string} bucket ë²„í‚·ëª…\r\n     * @param {string} fileName íŒŒì¼ëª…\r\n     * @returns {string} imageUrl ì´ë¯¸ì§€ url\r\n     */</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> fileName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">String</span> imageUrl <span class=\"token operator\">=</span> amazonS3Client<span class=\"token punctuation\">.</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span>bucket<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> imageUrl<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">/**\r\n     * S3 íŒŒì¼ ì—…ë¡œë“œë¥¼ ìœ„í•œ ê²½ë¡œ ì¬ì •ì˜\r\n     * @param {File} uploadFile ì—…ë¡œë“œí•  íŒŒì¼\r\n     * @param {string} dirName ê²½ë¡œëª…\r\n     * @returns {string} uploadImageUrl\r\n     */</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">uploadMultipart</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MultipartFile</span> multipartFile<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> dirName<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">File</span> uploadFile <span class=\"token operator\">=</span> <span class=\"token function\">convert</span><span class=\"token punctuation\">(</span>multipartFile<span class=\"token punctuation\">)</span>  <span class=\"token comment\">// íŒŒì¼ ë³€í™˜í•  ìˆ˜ ì—†ìœ¼ë©´ ì—ëŸ¬</span>\r\n                <span class=\"token punctuation\">.</span><span class=\"token function\">orElseThrow</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">IllegalArgumentException</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"error: MultipartFile -> File convert fail\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">return</span> <span class=\"token function\">upload</span><span class=\"token punctuation\">(</span>uploadFile<span class=\"token punctuation\">,</span> dirName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">/**\r\n     * S3 íŒŒì¼ ì—…ë¡œë“œë¥¼ ìœ„í•œ ê²½ë¡œ ì¬ì •ì˜\r\n     * @param {File} uploadFile ì—…ë¡œë“œí•  íŒŒì¼\r\n     * @param {string} dirName ê²½ë¡œëª…\r\n     * @returns {string} uploadImageUrl\r\n     */</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">upload</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">File</span> uploadFile<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> dirName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">String</span> fileName <span class=\"token operator\">=</span> dirName <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> uploadFile<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">String</span> uploadImageUrl <span class=\"token operator\">=</span> <span class=\"token function\">putS3</span><span class=\"token punctuation\">(</span>uploadFile<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token function\">removeNewFile</span><span class=\"token punctuation\">(</span>uploadFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> uploadImageUrl<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">/**\r\n     * S3 ì—…ë¡œë“œ\r\n     * @param {File} uploadFile ì—…ë¡œë“œí•  íŒŒì¼\r\n     * @param {string} fileName íŒŒì¼ëª…\r\n     * @returns {string} awsS3UrlName ì—…ë¡œë“œëœ url\r\n     */</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">String</span> <span class=\"token function\">putS3</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">File</span> uploadFile<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> fileName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        amazonS3Client<span class=\"token punctuation\">.</span><span class=\"token function\">putObject</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">PutObjectRequest</span><span class=\"token punctuation\">(</span>bucket<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">,</span> uploadFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">withCannedAcl</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">CannedAccessControlList<span class=\"token punctuation\">.</span>PublicRead</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">String</span> awsS3UrlName <span class=\"token operator\">=</span> amazonS3Client<span class=\"token punctuation\">.</span><span class=\"token function\">getUrl</span><span class=\"token punctuation\">(</span>bucket<span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">return</span> awsS3UrlName<span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">/**\r\n     * S3 ë‹¤ìš´ë¡œë“œ\r\n     * @param {string} fileName íŒŒì¼ëª…\r\n     * @returns {S3Object} obj ê°ì²´\r\n     */</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token function\">download</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">String</span> storedFileName<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">S3Object</span> o <span class=\"token operator\">=</span> amazonS3Client<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">GetObjectRequest</span><span class=\"token punctuation\">(</span>bucket<span class=\"token punctuation\">,</span> storedFileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">S3ObjectInputStream</span> objectInputStream <span class=\"token operator\">=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">getObjectContent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> bytes <span class=\"token operator\">=</span> <span class=\"token class-name\">IOUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">toByteArray</span><span class=\"token punctuation\">(</span>objectInputStream<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">String</span> fileName <span class=\"token operator\">=</span> <span class=\"token class-name\">URLEncoder</span><span class=\"token punctuation\">.</span><span class=\"token function\">encode</span><span class=\"token punctuation\">(</span>storedFileName<span class=\"token punctuation\">,</span> <span class=\"token string\">\"UTF-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">replaceAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\\\+\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"%20\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token class-name\">HttpHeaders</span> httpHeaders <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">HttpHeaders</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        httpHeaders<span class=\"token punctuation\">.</span><span class=\"token function\">setContentType</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MediaType</span><span class=\"token punctuation\">.</span>APPLICATION_OCTET_STREAM<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        httpHeaders<span class=\"token punctuation\">.</span><span class=\"token function\">setContentLength</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        httpHeaders<span class=\"token punctuation\">.</span><span class=\"token function\">setContentDispositionFormData</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"attachment\"</span><span class=\"token punctuation\">,</span> fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">,</span> httpHeaders<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpStatus</span><span class=\"token punctuation\">.</span>OK<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n\r\n    <span class=\"token comment\">// ë¡œì»¬ì— ì €ì¥ëœ ì´ë¯¸ì§€ ì§€ìš°ê¸°</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">removeNewFile</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">File</span> targetFile<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>targetFile<span class=\"token punctuation\">.</span><span class=\"token function\">delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"File delete success\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"File delete fail\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">// ë¡œì»¬ì— íŒŒì¼ ì—…ë¡œë“œ í•˜ê¸°</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Optional</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">File</span><span class=\"token punctuation\">></span></span> <span class=\"token function\">convert</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MultipartFile</span> file<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">IOException</span> <span class=\"token punctuation\">{</span>\r\n        <span class=\"token class-name\">File</span> convertFile <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">File</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span><span class=\"token function\">getProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"user.dir\"</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> file<span class=\"token punctuation\">.</span><span class=\"token function\">getOriginalFilename</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>convertFile<span class=\"token punctuation\">.</span><span class=\"token function\">createNewFile</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// ë°”ë¡œ ìœ„ì—ì„œ ì§€ì •í•œ ê²½ë¡œì— Fileì´ ìƒì„±ë¨ (ê²½ë¡œê°€ ì˜ëª»ë˜ì—ˆë‹¤ë©´ ìƒì„± ë¶ˆê°€ëŠ¥)</span>\r\n            <span class=\"token keyword\">try</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileOutputStream</span> fos <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileOutputStream</span><span class=\"token punctuation\">(</span>convertFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// FileOutputStream ë°ì´í„°ë¥¼ íŒŒì¼ì— ë°”ì´íŠ¸ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì €ì¥í•˜ê¸° ìœ„í•¨</span>\r\n                fos<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">.</span><span class=\"token function\">getBytes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token punctuation\">}</span>\r\n            <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">of</span><span class=\"token punctuation\">(</span>convertFile<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n\r\n        <span class=\"token keyword\">return</span> <span class=\"token class-name\">Optional</span><span class=\"token punctuation\">.</span><span class=\"token function\">empty</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>S3ì— ì ‘ê·¼í›„ ë‚´ê°€ í•„ìš”í•œ ì‘ì—…ë“¤ì„ ì •ì˜í•´ì¤€ë‹¤.</p>\n<p>CheckController</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@RestController</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">CheckController</span> <span class=\"token punctuation\">{</span>\r\n    <span class=\"token annotation punctuation\">@Autowired</span>\r\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">S3Service</span> s3Service<span class=\"token punctuation\">;</span>\r\n    <span class=\"token comment\">//multipartfile ì—…ë¡œë“œì‹œ</span>\r\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/fileUpload\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">check</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@RequestParam</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"file\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">MultipartFile</span> file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n            s3Service<span class=\"token punctuation\">.</span><span class=\"token function\">uploadMultipart</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span><span class=\"token string\">\"uploadTest\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">IOException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"OK\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">//ì„œë²„ì— ì €ì¥ë˜ì–´ ìˆëŠ” íŒŒì¼ ì—…ë¡œë“œì‹œ</span>\r\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/localUpload\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">fileUpload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n            <span class=\"token class-name\">String</span> fileName <span class=\"token operator\">=</span> <span class=\"token string\">\"mey.jpg\"</span><span class=\"token punctuation\">;</span>\r\n            <span class=\"token class-name\">File</span> file <span class=\"token operator\">=</span> <span class=\"token class-name\">ResourceUtils</span><span class=\"token punctuation\">.</span><span class=\"token function\">getFile</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"classpath:static/image/test/\"</span><span class=\"token operator\">+</span>fileName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n            s3Service<span class=\"token punctuation\">.</span><span class=\"token function\">upload</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">,</span><span class=\"token string\">\"uploadTest\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">FileNotFoundException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n            e<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n        <span class=\"token punctuation\">}</span>\r\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"OK\"</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n    <span class=\"token comment\">//S3ì— ì €ì¥ëœ íŒŒì¼ ë‹¤ìš´ë¡œë“œ</span>\r\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/localDown\"</span><span class=\"token punctuation\">)</span>\r\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">ResponseEntity</span><span class=\"token operator\">&lt;</span><span class=\"token keyword\">byte</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">></span> <span class=\"token function\">fileDownload</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span>  <span class=\"token class-name\">IOException</span><span class=\"token punctuation\">{</span>\r\n        <span class=\"token keyword\">return</span> s3Service<span class=\"token punctuation\">.</span><span class=\"token function\">download</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"uploadTest/mey.jpg\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n    <span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ë‚˜ëŠ” ë‘ê°€ì§€ ë°©ì‹ì„ í…ŒìŠ¤íŠ¸ í•˜ë ¤í•œë‹¤</p>\n<p>ì²«ë²ˆì§¸ resources ì˜ì—­ì— ë‚´ê°€ ë¯¸ë¦¬ ë„£ì–´ë‘” ì´ë¯¸ì§€íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ëŠ” ë°©ì‹</p>\n<p>ë‘ë²ˆì§¸ í¬ìŠ¤íŠ¸ ë§¨ìœ¼ë¡œ multipartfileì„ ë³´ë‚´ ì—…ë¡œë“œ í•˜ëŠ” ë°©ì‹</p>\n<p>ì‚¬ì‹¤ ë‘˜ë‹¤ ë¡œì»¬ì— í•œë²ˆ ì €ì¥í•˜ëŠ” ê³¼ì •ì´ í•„ìš”í•˜ë‹¤ s3serviceë¥¼ ë³´ë©´ ë” ìì„¸íˆ ì•Œìˆ˜ìˆë‹¤.</p>\n<ol start=\"4\">\n<li>í¬ìŠ¤íŠ¸ ë§¨ì„ í†µí•œ í…ŒìŠ¤íŠ¸</li>\n</ol>\n<p>ë¨¼ì € ì²«ë²ˆì§¸ ë°©ì‹ì„ í…ŒìŠ¤íŠ¸ í•´ë³´ì ì•„ë˜ì™€ê°™ì´ ìš”ì²­ì„ í–ˆì„ë•Œ</p>\n<p><img src=\"/d2cd2b36d8fc8ede145cc9291e5b2593/springboots32.png\" alt=\"springboots32.PNG\"></p>\n<p>ë‚´ê°€ ìƒì„±í•œ ë²„í‚·ì— ì„¤ì •í•œ í´ë”ëª…ì´ ìƒê¸°ê³  í´ë¦­í•´ë³´ë©´ ë¡œì»¬ì— ë„£ì–´ë†¨ë˜ íŒŒì¼ì´ ì €ì¥ë˜ì–´ ìˆë‹¤.</p>\n<p><img src=\"/e8d5cc1ad037cc188e1024714b22b5ca/springboots33.png\" alt=\"springboots33.PNG\"></p>\n<p><img src=\"/aad62088b69c8694ec69ba188ec2ed6f/springboots34.png\" alt=\"springboots34.PNG\"></p>\n<p>ë‘ë²ˆì§¸ ë°©ì‹ë„ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì</p>\n<p>ì•„ë˜ì™€ ê°™ì´ íŒŒì¼ì„ ë„£ì–´ì„œ ìš”ì²­í•´ ë³´ë©´</p>\n<p><img src=\"/b63ed1f3be39f32466aa13d41e46e8de/springboots35.png\" alt=\"springboots35.PNG\"></p>\n<p>ê°™ì€ ë²„í‚·ì˜ í´ë”ì— ì•„ë˜ì™€ ê°™ì´ ë‚´ê°€ë³´ë‚¸ íŒŒì¼ì´ ì—…ë¡œë“œ ëœê±¸ ë³¼ìˆ˜ìˆë‹¤.</p>\n<p><img src=\"/f2c0d82b46ace6be0f081748ded7a793/springboots36.png\" alt=\"springboots36.PNG\"></p>\n<ol start=\"5\">\n<li>S3 ê°ì²´ ë‹¤ìš´ë¡œë“œ í…ŒìŠ¤íŠ¸</li>\n</ol>\n<p>ë¸Œë¼ìš°ì € ì°½ì„ í•˜ë‚˜ ì—´ê³  ë‹¤ìš´ë¡œë“œ í…ŒìŠ¤íŠ¸ë¥¼ í•´ë³´ì</p>\n<p>ì•„ë˜ì²˜ëŸ¼ ë‚´ê°€ ë°©ê¸ˆ ì—…ë¡œë“œí•œ íŒŒì¼ì´ ì˜ ë‹¤ìš´ë¡œë“œ ë˜ëŠ”ê±¸ í™•ì¸í• ìˆ˜ ìˆë‹¤.</p>\n<p><img src=\"/30878cf845f3091536f74d31978985f5/springboots37.png\" alt=\"springboots37.PNG\"></p>\n<h2 id=\"ë§ˆë¬´ë¦¬\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"ë§ˆë¬´ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸŒ­ë§ˆë¬´ë¦¬</h2>\n<p>ì´ì²˜ëŸ¼ ê°„ë‹¨í•˜ê²Œ springbootë¥¼ ì‚¬ìš©í•˜ì—¬ s3ì— ì ‘ê·¼í›„ íŒŒì¼ ì—…ë¡œë“œ ë‹¤ìš´ë¡œë“œë¥¼ êµ¬í˜„í•´ ë³´ì•˜ë‹¤.</p>\n<p>êµ‰ì¥íˆ ê°„ë‹¨í•œ ì˜ˆì œì´ë¯€ë¡œ ê³µì‹ë¬¸ì„œë“±ì„ ì°¸ê³ í•˜ì—¬ ì¢€ë” ì—¬ëŸ¬ ë°©ì‹ìœ¼ë¡œ ì‚¬ìš©ì´ ê°€ëŠ¥í•˜ë‹¤ ìƒê°ëœë‹¤.</p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EA%B0%9C%EC%9A%94\">ğŸ‘€ ê°œìš”</a></li>\n<li><a href=\"#-s3-%ED%8C%8C%EC%9D%BC-%EC%97%85%EB%A1%9C%EB%93%9C\">ğŸ—‘ S3 íŒŒì¼ ì—…ë¡œë“œ</a></li>\n<li><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\">ğŸŒ­ë§ˆë¬´ë¦¬</a></li>\n</ul>\n</div>","excerpt":"ğŸ‘€ ê°œìš” ì´ì „ í¬ìŠ¤íŒ… ì—ì„œ S3ì— ëŒ€í•´ì„œ ê°„ë‹¨í•˜ê²Œ ë‹¤ë¤˜ì—ˆë‹¤. ìš”ë²ˆì—ëŠ” S3ì— íŒŒì¼ì„ ì—…ë¡œë“œí•˜ëŠ” ê³¼ì •ì„ í¬ìŠ¤íŒ… í•˜ë ¤í•œë‹¤. â— S3ì— ëŒ€í•´ì„œëŠ” ì´ì „ í¬ìŠ¤íŒ… ì°¸ê³  S3ë€? ğŸ¦º S3 ë²„í‚· ìƒì„±ì— ëŒ€í•´ì„œëŠ” ì´ì „ í¬ìŠ¤íŒ… ì°¸ê³  S3 ë²„í‚· ìƒì„± ğŸ—‘ S3 íŒŒì¼ ì—…ë¡œë“œ ë²„í‚· ìƒì„± ì¼ë‹¨ ë‚˜ëŠ” ì•„ë˜ ê·¸ë¦¼ì²˜ëŸ¼ file-upload-test-lee ë¼ëŠ” ëª…ì¹­ìœ¼ë¡œ í¼ë¸”ë¦­í•œ ë²„í‚·ì„ í•˜ë‚˜ ìƒì„±í–ˆë‹¤.\r\nspringboots3.PNG í•´ë‹¹ ë²„í‚·ì„ í´ë¦­í•˜ì—¬ ë“¤ì–´ê°€ë©´ ì•„ë¬´ëŸ° ê°ì²´ë„ ì—†ëŠ” ìƒíƒœì´ë‹¤.\r\nspringboots31.PNG ê·¸ë¦¬ê³  iam ê¶Œí•œì— ì‚¬ìš©ìì—ê²Œ S3FullAccess ê¶Œí•œì„ ë¶€ì—¬í•´ì•¼ í•©ë‹ˆë‹¤. (ì´ê²ƒì´ ìˆì–´ì•¼ S3ì— íŒŒì¼ ì—…ë¡œë“œë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.) ì¼ë‹¨ aws ìƒì—ì„œì˜ ì‘ì—…ì€ ì´ì •ë„ë§Œ í•´ì£¼ë©´ëœë‹¤. ì´ì œ ì‹¤ì œ ì–´í”Œë¦¬ì¼€ì´ì…˜ ì—ì„œ aws s3 ì„œë¹„ìŠ¤ë¥¼ êµ¬í˜„í•´ ë³´ì. AmazonS3ClientBuilder ë¥¼ ì‚¬ìš©í•œ ì—…ë¡œë“œ êµ¬í˜„ ì˜ì¡´ì„± ì¶”ê°€ í”„ë¡œì íŠ¸ êµ¬ì¡° AmazonS3Config CheckControlleâ€¦","frontmatter":{"date":"March 07, 2022","title":"AWS S3 íŒŒì¼ ì—…ë¡œë“œ,ë‹¤ìš´ë¡œë“œ","categories":"SpringBoot","author":"ì©¡ê¸°","emoji":"ğŸ‘–"},"fields":{"slug":"/gatsby-springboot-study-s3-service/"}},"next":{"id":"62fdf0f9-ecfd-56ae-95b1-31bd2e63648d","html":"<h2 id=\"-ê¸°ì´ˆì™¸ë¶€-api-í˜¸ì¶œ\" style=\"position:relative;\"><a href=\"#-%EA%B8%B0%EC%B4%88%EC%99%B8%EB%B6%80-api-%ED%98%B8%EC%B6%9C\" aria-label=\" ê¸°ì´ˆì™¸ë¶€ api í˜¸ì¶œ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ‹ ê¸°ì´ˆ(ì™¸ë¶€ API í˜¸ì¶œ)</h2>\n<p>ì •ë§ ê°„ë‹¨í•œ ì»¨íŠ¸ë¡¤ëŸ¬ ì—ì„œ ì‚¬ìš©í•˜ëŠ” ê¸°ë³¸ ì˜ˆì œì´ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">package</span> <span class=\"token namespace\">controller</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">BufferedReader</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">InputStreamReader</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>io<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">OutputStreamWriter</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>net<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">HttpURLConnection</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">java<span class=\"token punctuation\">.</span>net<span class=\"token punctuation\">.</span></span>URL<span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>json<span class=\"token punctuation\">.</span>simple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>json<span class=\"token punctuation\">.</span>simple<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">JSONValue</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>stereotype<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">Controller</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RequestMapping</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">RequestMethod</span><span class=\"token punctuation\">;</span>\r\n<span class=\"token keyword\">import</span> <span class=\"token namespace\">org<span class=\"token punctuation\">.</span>springframework<span class=\"token punctuation\">.</span>web<span class=\"token punctuation\">.</span>bind<span class=\"token punctuation\">.</span>annotation<span class=\"token punctuation\">.</span></span><span class=\"token class-name\">ResponseBody</span><span class=\"token punctuation\">;</span>\r\n\r\n<span class=\"token annotation punctuation\">@Controller</span>\r\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">Test_api</span> <span class=\"token punctuation\">{</span>\r\n\r\n\t<span class=\"token annotation punctuation\">@RequestMapping</span><span class=\"token punctuation\">(</span>value <span class=\"token operator\">=</span> <span class=\"token string\">\"/test-api\"</span><span class=\"token punctuation\">,</span> produces<span class=\"token operator\">=</span><span class=\"token string\">\"application/json;charset=UTF-8\"</span><span class=\"token punctuation\">,</span> method <span class=\"token operator\">=</span> <span class=\"token class-name\">RequestMethod</span><span class=\"token punctuation\">.</span>GET<span class=\"token punctuation\">)</span>\r\n\t<span class=\"token annotation punctuation\">@ResponseBody</span>\r\n\t<span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">testServiceApi</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\r\n\r\n\r\n\t\t<span class=\"token class-name\">String</span> body_contents1 <span class=\"token operator\">=</span> <span class=\"token string\">\"body_text\"</span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token class-name\">String</span> result_txt <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\r\n\r\n\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\r\n\t\t\t<span class=\"token class-name\">JSONObject</span> reqParams <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t\treqParams<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"body_contents1\"</span><span class=\"token punctuation\">,</span> body_contents1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// bodyì— ë“¤ì–´ê°ˆ ë‚´ìš©ì„ ë‹´ëŠ”ë‹¤.</span>\r\n\r\n\t\t\t<span class=\"token class-name\">URL</span> url <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token function\">URL</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://www.test.com/test/open/order/possible-check\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// í˜¸ì¶œí•  ì™¸ë¶€ API ë¥¼ ì…ë ¥í•œë‹¤.</span>\r\n\r\n\t\t\t<span class=\"token class-name\">HttpURLConnection</span> conn <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpURLConnection</span><span class=\"token punctuation\">)</span> url<span class=\"token punctuation\">.</span><span class=\"token function\">openConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// headerì— ë°ì´í„° í†µì‹  ë°©ë²•ì„ ì§€ì •í•œë‹¤.</span>\r\n\t\t\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">setRequestMethod</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"POST\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">setRequestProperty</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Content-Type\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"application/json; utf-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t\t\t<span class=\"token comment\">// Postì¸ ê²½ìš° ë°ì´í„°ë¥¼ OutputStreamìœ¼ë¡œ ë„˜ê²¨ ì£¼ê² ë‹¤ëŠ” ì„¤ì •</span>\r\n\t\t\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">setDoOutput</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t\t\t<span class=\"token comment\">// Request body messageì— ì „ì†¡</span>\r\n\t\t\t<span class=\"token class-name\">OutputStreamWriter</span> os <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">OutputStreamWriter</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">.</span><span class=\"token function\">getOutputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t\tos<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span>reqParams<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t\tos<span class=\"token punctuation\">.</span><span class=\"token function\">flush</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t\t\t<span class=\"token comment\">// ì‘ë‹µ</span>\r\n\t\t\t<span class=\"token class-name\">BufferedReader</span> in <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">BufferedReader</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">InputStreamReader</span><span class=\"token punctuation\">(</span>conn<span class=\"token punctuation\">.</span><span class=\"token function\">getInputStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"UTF-8\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t\t<span class=\"token class-name\">JSONObject</span> jsonObj <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">JSONObject</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">JSONValue</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>in<span class=\"token punctuation\">.</span><span class=\"token function\">readLine</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t\t\tin<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t\tconn<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t\t\tresult_txt <span class=\"token operator\">=</span> <span class=\"token string\">\"response :: \"</span> <span class=\"token operator\">+</span> jsonObj<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"result\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>result_txt<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\r\n\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Exception</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\r\n\t\t\te<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\r\n\t\t<span class=\"token punctuation\">}</span>\r\n\t\t<span class=\"token keyword\">return</span> result_txt<span class=\"token punctuation\">;</span>\r\n\t<span class=\"token punctuation\">}</span>\r\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"-ë§ˆë¬´ë¦¬\" style=\"position:relative;\"><a href=\"#-%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\" ë§ˆë¬´ë¦¬ permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>ğŸ ë§ˆë¬´ë¦¬</h2>\n<p>ì»¨íŠ¸ë¡¤ëŸ¬ ì—ì„œ ì§€ì •í•œ ì™¸ë¶€ apië¥¼ í˜¸ì¶œí•˜ëŠ” ì˜ˆì œì´ë‹¤.</p>\n<p>í•˜ì§€ë§Œ ì‹¤ì œë¡œëŠ” ì™¸ë¶€apië¥¼ í˜¸ì¶œí•œë‹¤ìŒ ë‹¤ë¥¸ ì‘ì—…ë“¤ì„ ë§ì´ í•´ì£¼ëŠ”í¸ì´ë‹¤ ê·¸ëŸ¬ë¯€ë¡œ ì„œë¹„ìŠ¤ë‹¨ì—ì„œ ì‘ì„±í•´ì£¼ëŠ” ê²½ìš°ê°€ ë§ì€ê±°ê°™ë‹¤.\r\n<br>\r\n<br></p>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#-%EA%B8%B0%EC%B4%88%EC%99%B8%EB%B6%80-api-%ED%98%B8%EC%B6%9C\">ğŸ‹ ê¸°ì´ˆ(ì™¸ë¶€ API í˜¸ì¶œ)</a></li>\n<li><a href=\"#-%EB%A7%88%EB%AC%B4%EB%A6%AC\">ğŸ ë§ˆë¬´ë¦¬</a></li>\n</ul>\n</div>","frontmatter":{"date":"March 04, 2022","title":"Java ì™¸ë¶€ api í˜¸ì¶œ ë°©ë²•","categories":"JAVA","author":"ì©¡ê¸°","emoji":"ğŸ„"},"fields":{"slug":"/gatsby-java-study/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://leesungki.github.io","comments":{"utterances":{"repo":"LeeSungKi/leesungki.github.io"}}}}},"pageContext":{"slug":"/gatsby-springboot-study-s3-service/","nextSlug":"/gatsby-java-study/","prevSlug":""}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}