{
    "componentChunkName": "component---src-templates-blog-template-js",
    "path": "/springbootCookieAndSession(part.5)/",
    "result": {"data":{"cur":{"id":"d6d3e16b-9d53-5031-8479-d1d3ca9a9d81","html":"<h2 id=\"-세션-동작-방식으로-로그인-처리하기\" style=\"position:relative;\"><a href=\"#-%EC%84%B8%EC%85%98-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D%EC%9C%BC%EB%A1%9C-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0\" aria-label=\" 세션 동작 방식으로 로그인 처리하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎈 세션 동작 방식으로 로그인 처리하기!</h2>\n<ul>\n<li>지난 시간에는 쿠키로 처리할때 나타나는 치명적인 단점을 살펴보았고, 해결 방안에 대해 알아보았다</li>\n<li>이어 해결 방안을 구현해 어플리케이션의 보안 문제를 해결 해 보자!</li>\n</ul>\n<h3 id=\"목표\" style=\"position:relative;\"><a href=\"#%EB%AA%A9%ED%91%9C\" aria-label=\"목표 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>목표</h3>\n<ul>\n<li>앞서 쿠키에 중요한 정보를 보관하는 방법에는 여러가지의 보안 이슈가 발생했었다.</li>\n<li>이 문제를 해결하려면 결국 중요한 정보를 모두 서버에 저장 해야 한다. 그리고 클라이언트와 서버는 추정 불가능한 임의의 식별자 값으로 연결 해야 한다.</li>\n<li>이렇게 서버에 중요한 정보를 보관하고 연결을 유지하는 방법을 세션 이라 한다.</li>\n</ul>\n<h3 id=\"세션-동작-방식\" style=\"position:relative;\"><a href=\"#%EC%84%B8%EC%85%98-%EB%8F%99%EC%9E%91-%EB%B0%A9%EC%8B%9D\" aria-label=\"세션 동작 방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>세션 동작 방식</h3>\n<ul>\n<li>세션을 어떻게 개발할지 먼저 개념을 이해해보자.</li>\n</ul>\n<ol>\n<li>로그인\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 52.77777777777778%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABPUlEQVQoz5WTW6uCUBCF/f+/Ruipt+jJC4FQ0oskmhqZl7SL3XTFmsP2SCfiNDCyZ7vnm7VnVNN1HXmeg/Z4PHpv2/YrVznaaDRCURT41rqu613FAuTjdrthuVxiPp+Lcx0EAQ6HA67Xq1R/B3mFC5DqwjCEaZqwbRuGYcBxHLiui91uJ+rv9/sfhWVZIkkSHI/Hfk+Ak8kE0+kU2+0Wp9MJdV2LV1UlzoRhzPV+v8dsNgNzeRvegvsCtCwLq9Wqr6Ckq0ZT3avzDNWNx2MR4vs+0jT9ATJp2NhPQ1AF1Tn2nlenchYgS3s3tVencUiLxQKbzQae5yHLMlG1Xq9lBnEcC1j7BFIwVmaPLpeL9IvKhsNomka+5fP5/KvwkxHIgRFIMIGM2QIFpFoW0/77J/AwpxtFkUAZq3fDGTwBCLZSqMMoIgEAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"first.png\"\n        title=\"first.png\"\n        src=\"/static/68dfed4acf12f4a437d1c8966cbaf854/37523/first.png\"\n        srcset=\"/static/68dfed4acf12f4a437d1c8966cbaf854/e9ff0/first.png 180w,\n/static/68dfed4acf12f4a437d1c8966cbaf854/f21e7/first.png 360w,\n/static/68dfed4acf12f4a437d1c8966cbaf854/37523/first.png 720w,\n/static/68dfed4acf12f4a437d1c8966cbaf854/302a4/first.png 1080w,\n/static/68dfed4acf12f4a437d1c8966cbaf854/07a9c/first.png 1440w,\n/static/68dfed4acf12f4a437d1c8966cbaf854/cb425/first.png 1678w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></li>\n</ol>\n<ul>\n<li>사용자가 <code class=\"language-text\">loginId</code>,<code class=\"language-text\">password</code> 정보를 전달하면, 서버에서 해당 사용자가 맞는지 확인을 한다.</li>\n</ul>\n<ol start=\"2\">\n<li>\n<p>세션 생성\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABHklEQVQoz6VSyYqEUAz0/7/Gk+DNm6DoQRQPogdBRXDBfTdNBZ50N/ZMDxMon0+TylKRgiAgTdMIdhzHvyE5jkOyLFOe5/QXO8/zgrgz4bIsNM8zDcNAXddR3/d84r6uKzuJoGeyO3ImbJqG6rrmCouioLIsGVVVMfE0TZxw3/cLMCTMsoz9hDGh67qkqirpuk5t274Aye7u6MLzPFIUhQzDYDJ0imTSOI5kmiY7f2MgjKKI0jQly7K4ym3buAuuEI+7Qb8D2REUxzH5vk9JknAMvmPWGA1XKAh/IoNhzrZtE9YsDEM+kQAQc0bbL4Sf1gMGgSAaxICAaFkIBB8QolJJrMVvFWLWqESoL9ZKEOL9avlbYPhYKQjz/k8kfwBLuVZulXxbOAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"second.png\"\n        title=\"second.png\"\n        src=\"/static/6d8c5309dacbdff9925f4874e94462c5/37523/second.png\"\n        srcset=\"/static/6d8c5309dacbdff9925f4874e94462c5/e9ff0/second.png 180w,\n/static/6d8c5309dacbdff9925f4874e94462c5/f21e7/second.png 360w,\n/static/6d8c5309dacbdff9925f4874e94462c5/37523/second.png 720w,\n/static/6d8c5309dacbdff9925f4874e94462c5/302a4/second.png 1080w,\n/static/6d8c5309dacbdff9925f4874e94462c5/07a9c/second.png 1440w,\n/static/6d8c5309dacbdff9925f4874e94462c5/cb425/second.png 1678w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>세션 ID를 생성하는데, 추정 불가능 해야하는 값이여야만 한다.</li>\n<li>그래서 사용하는것이 **<code class=\"language-text\">UUID</code>**이다. 해당객체는 절대 겹치지 않는 임의의 값을 만들어주는 객체로, 쿠키에 해당옵션을 주기에 아주 적당하다.</li>\n<li>ex) <code class=\"language-text\">Cookie: mySessionId=zz0101xx-bab9-4b92-9b32-dadb280f4b61</code></li>\n<li>생성된 세션 ID와 세션이 보관할 값<code class=\"language-text\">memberA</code>을 서버의 세션 저장소에 보관한다.</li>\n</ul>\n</li>\n<li>\n<p>세션 ID를 응답 쿠키로 전달한다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABnUlEQVQoz5WT3U6DQBCFeSafw/fwdbz3FXrRxJteGL0yqfYvNlowsa0YSH8oLJQFSi0cc6ZZYvxLnGRClmW+OXN2scbjMbrdLj5HXdc4HA6oqurfafV6PbRaLTiOg+l0Ks8syxrwb8E9k2YtwN1uJ4DNZgPP9+F5HuJYIc9z7Pd7UfoV/NO6AcZxjDAMEQQBkiSBUgpKRdhutyiKAmVZCtgUsQEjTVMsl0v53oQAR6MR2u02BoMBtNZIdYZQabjuK1zXFcWLxQK+7wuAIIpgXafTwXA4FBgnFSCV2JMnFEV+3AgnSB/Pcd9/gG1PxNfVaoX1eo0oisQK1jD7/b5MxwkaYJYXuBvY0jlJUnivDt7sG7y8zBAEa1HDsVhIpVTJdwQwCGPSHtphDXu3OD2xcHN9hbLcIwwVtrqk1dLReEaVVDSbzWDbNubzuRwmlVI1G9Bvy3+b4vLiDM/OE1ScQEURtE6/nSQLeXAspkomG5rDIJBKrfdDhVjXqP+4Z0yq4ViRNNTNtTJAc8WsY5eqGe+vv4Aj0Uv6/XXPNP4AJKFHvuednyMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"send_cookie.png\"\n        title=\"send_cookie.png\"\n        src=\"/static/9c2af652de5039b52e7aa2350ee4cb24/37523/send_cookie.png\"\n        srcset=\"/static/9c2af652de5039b52e7aa2350ee4cb24/e9ff0/send_cookie.png 180w,\n/static/9c2af652de5039b52e7aa2350ee4cb24/f21e7/send_cookie.png 360w,\n/static/9c2af652de5039b52e7aa2350ee4cb24/37523/send_cookie.png 720w,\n/static/9c2af652de5039b52e7aa2350ee4cb24/302a4/send_cookie.png 1080w,\n/static/9c2af652de5039b52e7aa2350ee4cb24/07a9c/send_cookie.png 1440w,\n/static/9c2af652de5039b52e7aa2350ee4cb24/cb425/send_cookie.png 1678w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li><strong>클라이언트와 서버는 결국 쿠키로 연결이 되어야 한다.</strong></li>\n<li>클라이언트는 쿠키 저장소에 <code class=\"language-text\">mySessionId</code>쿠키를 보관한다.\n<em><em>여기서 중요한 포인트!</em></em>\n<ul>\n<li>회원과 관련된 정보는 전혀 클라이언트에 전달되게 하면 안된다는 것이다.</li>\n<li>오직 추정 불가능한 세션ID(UUID로 변환된 임의의 값)만 쿠키를 통해 클라이언트에게 전달되게 한다.</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>클라이언트의 세션ID를 쿠키에 전달\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.44444444444444%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABdUlEQVQoz6VT22qDQBT0vf/Tj+gH9LP6G33La8lLofFBQkIJiBCJJhqrMSZGzV1NnDInLJQkUEoPHJTdPXNm5uxqWZYhDEOoOJ/P/0qt1+uh1WohTVPkeS6L96Jpml9TAIuiwHK5hG3bsCxLQMuyxPF4xG63k29d1zfF9xoK4OFwwH6/x2QyQb/fh2EYAuw4jiSZbzabGwA2qarqFtB1XQwGA5imidVqBc/zJJMkEebr9Rr0mXv8UkEcx6BV3W5X1n+Caixst98wm82kI2Wq4VBuFEUYjUaiYDgcCigb6bougBzodDoVJbRKq+sTwjhHWVVyeD6fSxKMUlkQBAHG4zE6nY6w556Syxqe2263sqa5jo2nxwfoH++g15RElmraPERGZLBYLOSfnrMBrfJ9X5gTkKEl8RdeX55hmZ/I8svElex701RBFbSLt4Ss6bUAUnJaVLiuvb5f10lGTA6FN4UkZChNQ2mXotPpb6+CILSCtqiX8g21bUgwQvPUlAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"send_to_client.png\"\n        title=\"send_to_client.png\"\n        src=\"/static/50b9d8be207d155e915db6e3b690f477/37523/send_to_client.png\"\n        srcset=\"/static/50b9d8be207d155e915db6e3b690f477/e9ff0/send_to_client.png 180w,\n/static/50b9d8be207d155e915db6e3b690f477/f21e7/send_to_client.png 360w,\n/static/50b9d8be207d155e915db6e3b690f477/37523/send_to_client.png 720w,\n/static/50b9d8be207d155e915db6e3b690f477/302a4/send_to_client.png 1080w,\n/static/50b9d8be207d155e915db6e3b690f477/07a9c/send_to_client.png 1440w,\n/static/50b9d8be207d155e915db6e3b690f477/cb425/send_to_client.png 1678w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></p>\n<ul>\n<li>클라이언트는 요청 시 항상 <code class=\"language-text\">mySessionId</code>라는 쿠키를 전달한다.</li>\n<li>서버에서는 클라이언트가 전달한 <code class=\"language-text\">mySessionId</code>쿠키의 정보로 세션 저장소를 조회해서, 로그인 시 보관한 세션의 정보를 사용한다.</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"정리\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC\" aria-label=\"정리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">* 세션을 사용하여 서버에서 중요한 정보를 관리하게 처리 하였다. 덕분에 다음과 같은 보안 문제들을 해결 할 수 있었다.\n  1. 쿠키의 값을 변조 가능 -> 예측 불가한 복잡한 세션ID를 사용.\n  2. 쿠키에 보관하는 정보는 클라이언트 해킹 시 털릴 가능성이 있다 -> 세션ID가 털리더라도 여기에는 중요한 정보가 없다.\n  3. 쿠키 탈취 이후 악용 -> 해커가 만약 토큰을 털어가도, 시간이 지나면 사용 할 수 없도록 세션에서 세션의 만료시간을 짧게 유지한다. 또는 해킹이 의심되는 경우 서버에서 해당 세션을 강제로 제거하면 된다.</code></pre></div>\n<h2 id=\"-로그인-처리---세션-직접-만들기\" style=\"position:relative;\"><a href=\"#-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%B2%98%EB%A6%AC---%EC%84%B8%EC%85%98-%EC%A7%81%EC%A0%91-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\" 로그인 처리   세션 직접 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌈 로그인 처리 - 세션 직접 만들기</h2>\n<ul>\n<li>\n<p>이번에는 세션을 직접 개발해서 적용해 볼것이다.</p>\n</li>\n<li>\n<p>세션 관리는 크게 다음 3가지의 기능을 제공하면 된다.</p>\n<ol>\n<li>세션 생성</li>\n</ol>\n<ul>\n<li>sessionId생성(임의의 추정 불가능한 랜덤 값)</li>\n<li>세션 저장소에 sessionId와 보관할 값을 저장</li>\n<li>sessionId로 응답 쿠키를 생성해서 클라이언트에 전달.</li>\n</ul>\n<ol start=\"2\">\n<li>세션 조회</li>\n</ol>\n<ul>\n<li>클라이언트가 요청한 sessionId 쿠키의 값으로, 세션 저장소에 보관한 값을 조회한다.</li>\n</ul>\n<ol start=\"3\">\n<li>세션 만료(30분)</li>\n</ol>\n<ul>\n<li>클라이언트가 요청한 sessionId 쿠키의 값으로, 세션 저장소에 보관된 sessionId와 값을 제거한다.</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"sessionmanager-세션관리\" style=\"position:relative;\"><a href=\"#sessionmanager-%EC%84%B8%EC%85%98%EA%B4%80%EB%A6%AC\" aria-label=\"sessionmanager 세션관리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SessionManager-세션관리</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">//web package에 해당 파일을 생성</span>\n  <span class=\"token annotation punctuation\">@Component</span>\n  <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SessionManager</span> <span class=\"token punctuation\">{</span>\n\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> SESSION_COOKIE_NAME <span class=\"token operator\">=</span> <span class=\"token string\">\"mySessionId\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Map</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Object</span><span class=\"token punctuation\">></span></span> sessionStore <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ConcurrentHashMap</span><span class=\"token generics\"><span class=\"token punctuation\">&lt;</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">/**\n    * 세션 생성\n    */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">createSession</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span> value<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n      <span class=\"token comment\">//세션 id를 생성하고, 값을 세션에 저장</span>\n      <span class=\"token class-name\">String</span> sessionId <span class=\"token operator\">=</span> UUID<span class=\"token punctuation\">.</span><span class=\"token function\">randomUUID</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      sessionStore<span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>sessionId<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n      <span class=\"token comment\">//쿠키 생성</span>\n      <span class=\"token class-name\">Cookie</span> mySessionCookie <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span>SESSION_COOKIE_NAME<span class=\"token punctuation\">,</span> sessionId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">addCookie</span><span class=\"token punctuation\">(</span>mySessionCookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token comment\">/**\n    * 세션 조회\n    */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">Object</span> <span class=\"token function\">getSession</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token class-name\">Cookie</span> sessionCookie <span class=\"token operator\">=</span> <span class=\"token function\">findCookie</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> SESSION_COOKIE_NAME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sessionCookie <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> sessionStore<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>sessionCookie<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">/**\n    * 세션 만료\n    */</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">expire</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token class-name\">Cookie</span> sessionCookie <span class=\"token operator\">=</span> <span class=\"token function\">findCookie</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">,</span> SESSION_COOKIE_NAME<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>sessionCookie <span class=\"token operator\">!=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          sessionStore<span class=\"token punctuation\">.</span><span class=\"token function\">remove</span><span class=\"token punctuation\">(</span>sessionCookie<span class=\"token punctuation\">.</span><span class=\"token function\">getValue</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">private</span> <span class=\"token class-name\">Cookie</span> <span class=\"token function\">findCookie</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletRequest</span> request<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> cookieName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">getCookies</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token keyword\">return</span> <span class=\"token class-name\">Arrays</span><span class=\"token punctuation\">.</span><span class=\"token function\">stream</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">.</span><span class=\"token function\">getCookies</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                  <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>cookie <span class=\"token operator\">-></span> cookie<span class=\"token punctuation\">.</span><span class=\"token function\">getName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">equals</span><span class=\"token punctuation\">(</span>cookieName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n                  <span class=\"token punctuation\">.</span><span class=\"token function\">findAny</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n                  <span class=\"token punctuation\">.</span><span class=\"token function\">orElse</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n</code></pre></div>\n<ul>\n<li>\n<p>해당 로직은 쿠키를 사용할때와 상당히 비슷한 맥락을 띄고 있어 그렇게 어렵지 않게 이해할 수 있을것이다. 설명을 조금 추가 해 보자면</p>\n</li>\n<li>\n<p><code class=\"language-text\">@Componet</code>:로 스프링빈에 자동 등록시킨다.</p>\n</li>\n<li>\n<p><code class=\"language-text\">ConcurrentHashMap</code>: <code class=\"language-text\">HashMap</code>은 동시 요청에 안전하지 않다. 동시 요청에 안전한 <code class=\"language-text\">ConcurrentHashMap</code>을 사용했다.</p>\n</li>\n<li>\n<p>자 그럼 이제 구성한 로직을 테스트를 해보자. 막상 구현해 놓은걸 테스트하는 작업은 상당히 중요하다..!</p>\n</li>\n</ul>\n<h3 id=\"sessionmanagertest\" style=\"position:relative;\"><a href=\"#sessionmanagertest\" aria-label=\"sessionmanagertest permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>SessionManagerTest</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">SessionManagerTest</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token class-name\">SessionManager</span> sessionManager <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SessionManager</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token annotation punctuation\">@Test</span>\n  <span class=\"token keyword\">void</span> <span class=\"token function\">sessionTest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">//세션 생성</span>\n    <span class=\"token class-name\">MockHttpServletResponse</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MockHttpServletResponse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Member</span> member <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Member</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    sessionManager<span class=\"token punctuation\">.</span><span class=\"token function\">createSession</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//요청에 응답 쿠키 저장</span>\n    <span class=\"token class-name\">MockHttpServletRequest</span> request <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MockHttpServletRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    request<span class=\"token punctuation\">.</span><span class=\"token function\">setCookies</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span><span class=\"token function\">getCookies</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//세션 조회</span>\n    <span class=\"token class-name\">Object</span> result <span class=\"token operator\">=</span> sessionManager<span class=\"token punctuation\">.</span><span class=\"token function\">getSession</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isEqualTo</span><span class=\"token punctuation\">(</span>member<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//세션 만료</span>\n    sessionManager<span class=\"token punctuation\">.</span><span class=\"token function\">expire</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token class-name\">Object</span> expired <span class=\"token operator\">=</span> sessionManager<span class=\"token punctuation\">.</span><span class=\"token function\">getSession</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">assertThat</span><span class=\"token punctuation\">(</span>expired<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">isNull</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>테스트 로직은 간단하게 구성하자. 여기서는 <code class=\"language-text\">HttpServletRequest</code>나 <code class=\"language-text\">HttpServletResponse</code> 객체를 직접 사용 할 수 없기 때문에(인터페이스),테스트 목적으로 사용할 가짜<code class=\"language-text\">MockHttpServlertRequest</code>,<code class=\"language-text\">MockHttpServlertResponse</code>를 사용하였다.</li>\n<li>테스트의 결과는 모두 정상적으로 초록색의 체크문양을 확인 할 수 있을 것이다. <strong>세션을 직접 만든것을 축하한다.</strong></li>\n<li>이제 테스트도 성공했고, 직접 만든 세션을 적용하는 일만 남았다.</li>\n</ul>\n<h2 id=\"-로그인-처리하기---직접-만든-세션-적용\" style=\"position:relative;\"><a href=\"#-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0---%EC%A7%81%EC%A0%91-%EB%A7%8C%EB%93%A0-%EC%84%B8%EC%85%98-%EC%A0%81%EC%9A%A9\" aria-label=\" 로그인 처리하기   직접 만든 세션 적용 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌚 로그인 처리하기 - 직접 만든 세션 적용</h2>\n<ul>\n<li>지금까지 개발한 세션 관리 기능을 실제 웹 애플리케이션에 적용하여 본다.</li>\n</ul>\n<h3 id=\"logincontroller-version2\" style=\"position:relative;\"><a href=\"#logincontroller-version2\" aria-label=\"logincontroller version2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>LoginController-version2</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">```java\n\n    //기존의 login메소드의 mapping은 주석처리!\n    @PostMapping(\"/login\")\n    public String loginV2(@Valid @ModelAttribute LoginForm form, BindingResult\n                          bindingResult, HttpServletResponse response) {\n      if (bindingResult.hasErrors()) {\n        return \"login/loginForm\";\n      }\n\n      Member loginMember = loginService.login(form.getLoginId(),form.getPassword());\n      log.info(\"login? {}\", loginMember);\n      if (loginMember == null) {\n        bindingResult.reject(\"loginFail\",\"아이디 또는 비밀번호가 맞지 않습니다.\");\n        return \"login/loginForm\";\n      }\n\n      //로그인 성공 처리\n      //세션 관리자를 통해 세션을 생성하고, 회원 데이터 보관 sessionManager.createSession(loginMember, response);\n      return \"redirect:/\";\n    }\n    //기존의 로그아웃메소드의 매핑도 주석처리!\n    @PostMapping(\"/logout\")\n    public String logoutV2(HttpServletRequest request) {\n      sessionManager.expire(request);\n      return \"redirect:/\";\n    }\n\n```\n\n  - `private final SessionManager`우리가 만들었던 로직을 주입시킨다.\n  - `sessionManager.createSession(loginMeber, response);`로그인 성공 시 세션을 등록한다. 세션에 `loginMember`를 저장해두고, 쿠키도 함께 발행시키는 로직이다.\n\n  - 로그아웃 시 해당 세션의 정보를 제거한다.\n  - 로그인과 로그아웃을 만들었으니, 이제 컨트롤러에 입혀주도록 하자.</code></pre></div>\n<h3 id=\"homecontroller-homeloginv2\" style=\"position:relative;\"><a href=\"#homecontroller-homeloginv2\" aria-label=\"homecontroller homeloginv2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>HomeController-homeLoginV2</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">```java\n\n  //기존의 홈로그인의 매핑은 주석처리하자!\n  @GetMapping(\"/\")\n  public String homeLoginV2(HttpServletRequest request, Model model) {\n\n    //세션 관리자에 저장된 회원 정보 조회\n    Member member = (Member)sessionManager.getSession(request); \n    if (member == null) {\n      return \"home\";\n    }\n    //로그인\n    model.addAttribute(\"member\", member); \n    return \"loginHome\";\n  }\n\n```</code></pre></div>\n<ul>\n<li><code class=\"language-text\">private final SessionManager sessionManager;</code>주입</li>\n<li>세션 관리자에서 저장된 회원 정보를 조회 한다. 만약 정보가 없으면, 쿠키나 세션이 없는 것 이므로, 로그인이 되지 않는 것으로 처리가 된다.</li>\n</ul>\n<h3 id=\"정리-1\" style=\"position:relative;\"><a href=\"#%EC%A0%95%EB%A6%AC-1\" aria-label=\"정리 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>정리</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">- 이번편에는 세션과 쿠키의 개념을 명확하게 하기 위해(어떤역할을 하는지 어떤방식으로 동작하는지)직접 만들어 사용해 보았다.\n- 사실 세션이라는 것이 뭔가 특별한 것이 아니라 단지 쿠키를 사용하는데, 서버에서 데이터를 유지하는 방법일 뿐이라는 것을 이해했을거라 생각한다.\n- 그런데 프로젝트마다 이러한 세션 개념을 직접 개발하는것은... 개발자의 입장에서 상당히 불편할 것이다.\n- 그래서 등장하는것이 서블릿이다. 이 서블릿도 세션개념을 지원한다.\n- 이제는 직접 만드는 세션 말고 **서블릿이 공식 지원 하는 세션**에 대해 알아 보려 한다. \n- 서블릿의 세션도 우리가 직접 만든 세션과 동작 방식이 아주 비슷하다. 추가로 세션을 일정시간 사용하지 않으면, 해당 세션을 삭제하는 기능도 제공한다.\n- 다음시간에는 서블릿에서 제공하는 세션에 대해 알아 보도록 하겠다.</code></pre></div>\n<p><strong>to be continue…(서블릿의 세션)</strong></p>","excerpt":"🎈 세션 동작 방식으로 로그인 처리하기! 지난 시간에는 쿠키로 처리할때 나타나는 치명적인 단점을 살펴보았고, 해결 방안에 대해 알아보았다 이어 해결 방안을 구현해 어플리케이션의 보안 문제를 해결 해 보자! 목표 앞서 쿠키에 중요한 정보를 보관하는 방법에는 여러가지의 보안 이슈가 발생했었다. 이 문제를 해결하려면 결국 중요한 정보를 모두 서버에 저장 해야 한다. 그리고 클라이언트와 서버는 추정 불가능한 임의의 식별자 값으로 연결 해야 한다. 이렇게 서버에 중요한 정보를 보관하고 연결을 유지하는 방법을 세션 이라 한다. 세션 동작 방식 세션을 어떻게 개발할지 먼저 개념을 이해해보자. 로그인\n 사용자가 , 정보를 전달하면, 서버에서 해당 사용자가 맞는지 확인을 한다. 세션 생성\n 세션 ID를 생성하는데, 추정 불가능 해야하는 값이여야만 한다. 그래서 사용하는것이 ****이다. 해당객체는 절대 겹치지 않는 임의의 값을 만들어주는 객체로, 쿠키에 해당옵션을 주기에 아주 적당하다. ex)  …","frontmatter":{"date":"December 07, 2023","title":"SpringBoot의 로그인 처리 쿠키와 세션(part.5 세션동작방식으로 로그인처리)","categories":"SpringBoot","author":"아구","emoji":"🪼"},"fields":{"slug":"/springbootCookieAndSession(part.5)/"}},"next":{"id":"5a0dfa84-8545-5b3d-b576-0e968fffc24b","html":"<h2 id=\"-로그인-성공-시-세션-쿠키-생성\" style=\"position:relative;\"><a href=\"#-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%84%B1%EA%B3%B5-%EC%8B%9C-%EC%84%B8%EC%85%98-%EC%BF%A0%ED%82%A4-%EC%83%9D%EC%84%B1\" aria-label=\" 로그인 성공 시 세션 쿠키 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎈 로그인 성공 시 세션 쿠키 생성</h2>\n<ul>\n<li>지난 시간에 이어 로그인에 필요한 세션 쿠키를 생성해 보도록 하자.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/login\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">login</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Valid</span> <span class=\"token annotation punctuation\">@ModelAttribute</span> <span class=\"token class-name\">LoginForm</span> form<span class=\"token punctuation\">,</span> <span class=\"token class-name\">BindingResult</span>\n  bindingResult<span class=\"token punctuation\">,</span> <span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>bindingResult<span class=\"token punctuation\">.</span><span class=\"token function\">hasErrors</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">\"login/loginForm\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token class-name\">Member</span> loginMember <span class=\"token operator\">=</span> loginService<span class=\"token punctuation\">.</span><span class=\"token function\">login</span><span class=\"token punctuation\">(</span>form<span class=\"token punctuation\">.</span><span class=\"token function\">getLoginId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    form<span class=\"token punctuation\">.</span><span class=\"token function\">getPassword</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    log<span class=\"token punctuation\">.</span><span class=\"token function\">info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"login? {}\"</span><span class=\"token punctuation\">,</span> loginMember<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>loginMember <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      bindingResult<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"loginFail\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"아이디 또는 비밀번호가 맞지 않습니다.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">\"login/loginForm\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token comment\">//로그인 성공 처리</span>\n    <span class=\"token comment\">//쿠키에 시간 정보를 주지 않으면 세션 쿠키(브라우저 종료시 모두 종료)</span>\n    <span class=\"token class-name\">Cookie</span> idCookie <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"memberId\"</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>loginMember<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    response<span class=\"token punctuation\">.</span><span class=\"token function\">addCookie</span><span class=\"token punctuation\">(</span>idCookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token string\">\"redirect:/\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>여기서 우리가 집중하여 볼것은 쿠키 생성 로직이다.</li>\n</ul>\n<h3 id=\"쿠키-생성-로직\" style=\"position:relative;\"><a href=\"#%EC%BF%A0%ED%82%A4-%EC%83%9D%EC%84%B1-%EB%A1%9C%EC%A7%81\" aria-label=\"쿠키 생성 로직 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>쿠키 생성 로직</h3>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token class-name\">Cookie</span> idCookie <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"memberId\"</span><span class=\"token punctuation\">,</span><span class=\"token class-name\">String</span><span class=\"token punctuation\">.</span><span class=\"token function\">valueOf</span><span class=\"token punctuation\">(</span>loginMember<span class=\"token punctuation\">.</span><span class=\"token function\">getId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nresponse<span class=\"token punctuation\">.</span><span class=\"token function\">addCookie</span><span class=\"token punctuation\">(</span>idCookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ul>\n<li>\n<h1 id=\"로그인에-성공시-쿠키를-생성하고-code-classlanguage-texthttpservletresponsecode에-담는다\" style=\"position:relative;\"><a href=\"#%EB%A1%9C%EA%B7%B8%EC%9D%B8%EC%97%90-%EC%84%B1%EA%B3%B5%EC%8B%9C-%EC%BF%A0%ED%82%A4%EB%A5%BC-%EC%83%9D%EC%84%B1%ED%95%98%EA%B3%A0-code-classlanguage-texthttpservletresponsecode%EC%97%90-%EB%8B%B4%EB%8A%94%EB%8B%A4\" aria-label=\"로그인에 성공시 쿠키를 생성하고 code classlanguage texthttpservletresponsecode에 담는다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>로그인에 성공시 쿠키를 생성하고 <code class=\"language-text\">HttpServletResponse</code>에 담는다.</h1>\n</li>\n<li>\n<h1 id=\"쿠키의-이름은-code-classlanguage-textmemberidcode이고-값은-회원의-code-classlanguage-textidcode를-담아둔다\" style=\"position:relative;\"><a href=\"#%EC%BF%A0%ED%82%A4%EC%9D%98-%EC%9D%B4%EB%A6%84%EC%9D%80-code-classlanguage-textmemberidcode%EC%9D%B4%EA%B3%A0-%EA%B0%92%EC%9D%80-%ED%9A%8C%EC%9B%90%EC%9D%98-code-classlanguage-textidcode%EB%A5%BC-%EB%8B%B4%EC%95%84%EB%91%94%EB%8B%A4\" aria-label=\"쿠키의 이름은 code classlanguage textmemberidcode이고 값은 회원의 code classlanguage textidcode를 담아둔다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>쿠키의 이름은 <code class=\"language-text\">memberId</code>이고, 값은 회원의 <code class=\"language-text\">id</code>를 담아둔다.</h1>\n</li>\n<li>\n<h1 id=\"웹-브라우저는-종료-전까지-회원의-값id를-서버에-지속적으로-보내줄것이다\" style=\"position:relative;\"><a href=\"#%EC%9B%B9-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EB%8A%94-%EC%A2%85%EB%A3%8C-%EC%A0%84%EA%B9%8C%EC%A7%80-%ED%9A%8C%EC%9B%90%EC%9D%98-%EA%B0%92id%EB%A5%BC-%EC%84%9C%EB%B2%84%EC%97%90-%EC%A7%80%EC%86%8D%EC%A0%81%EC%9C%BC%EB%A1%9C-%EB%B3%B4%EB%82%B4%EC%A4%84%EA%B2%83%EC%9D%B4%EB%8B%A4\" aria-label=\"웹 브라우저는 종료 전까지 회원의 값id를 서버에 지속적으로 보내줄것이다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>웹 브라우저는 종료 전까지 회원의 값(id)를 서버에 지속적으로 보내줄것이다.</h1>\n</li>\n</ul>\n<h3 id=\"실행\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89\" aria-label=\"실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실행</h3>\n<ul>\n<li>크롬 브라우저를 통해 HTTP 응답 헤더에 쿠키가 추가된 것을 확인할 수 있다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 26.666666666666668%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAABDklEQVQY01WP20oCURSGfZnmFAPO9kA2KoQ3BSXdSD1AhE8U9BK9QpF0QBSnKOjCLPOubgbCw+Te+4vZpuSCn/+Htfj4V0Zrzf+J45jxeGLycpe6VMrkp+cXDhonHB43qR812W+cslWqks0KfD9LJj2aJQmTaYLSMJcKmUottIRKKY1HUURYLhMEASJfRIg8QggKxSK5XG4BVPMZME27/Gl9TMMVsEdlu4S/6WFZG1iWhW3bKxlg/1NzdqU4v9ZcdBLanS6XrTtat+3V+0tgN3qgulsnCHewXQ/HcXBdF8/zjBvg17fmpq+5H8DjSPIxGvH6NmTwPiRJftaAnV5EWNujUKlhOa4BOo5rYGn+BWDCMU60dOVQAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"check_cookie.png\"\n        title=\"check_cookie.png\"\n        src=\"/static/f437ce26b0a2dfe25493b1f58ede4f15/37523/check_cookie.png\"\n        srcset=\"/static/f437ce26b0a2dfe25493b1f58ede4f15/e9ff0/check_cookie.png 180w,\n/static/f437ce26b0a2dfe25493b1f58ede4f15/f21e7/check_cookie.png 360w,\n/static/f437ce26b0a2dfe25493b1f58ede4f15/37523/check_cookie.png 720w,\n/static/f437ce26b0a2dfe25493b1f58ede4f15/302a4/check_cookie.png 1080w,\n/static/f437ce26b0a2dfe25493b1f58ede4f15/07a9c/check_cookie.png 1440w,\n/static/f437ce26b0a2dfe25493b1f58ede4f15/00602/check_cookie.png 1671w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n    </span></li>\n</ul>\n<h2 id=\"-홈화면-로그인처리\" style=\"position:relative;\"><a href=\"#-%ED%99%88%ED%99%94%EB%A9%B4-%EB%A1%9C%EA%B7%B8%EC%9D%B8%EC%B2%98%EB%A6%AC\" aria-label=\" 홈화면 로그인처리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌵 홈화면 로그인처리</h2>\n<ol>\n<li>HomeController</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token annotation punctuation\">@Slf4j</span>\n<span class=\"token annotation punctuation\">@Controller</span>\n<span class=\"token annotation punctuation\">@RequiredArgsConstructor</span>\n<span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">HomeController</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">private</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">MemberRepository</span> memberRepository<span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">//    @GetMapping(\"/\") *주의 기존거 주석처리 안하면 컴파일에러</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">home</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n    <span class=\"token annotation punctuation\">@GetMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">homeLogin</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@CookieValue</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"memberId\"</span><span class=\"token punctuation\">,</span> required <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">Long</span> memberId<span class=\"token punctuation\">,</span> <span class=\"token class-name\">Model</span> model<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>memberId <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      <span class=\"token comment\">//로그인</span>\n      <span class=\"token class-name\">Member</span> loginMember <span class=\"token operator\">=</span> memberRepository<span class=\"token punctuation\">.</span><span class=\"token function\">findById</span><span class=\"token punctuation\">(</span>memberId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>loginMember <span class=\"token operator\">==</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token string\">\"home\"</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n      model<span class=\"token punctuation\">.</span><span class=\"token function\">addAttribute</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"member\"</span><span class=\"token punctuation\">,</span> loginMember<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">\"loginHome\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>기존 <code class=\"language-text\">home()</code>메소드의 있는 <code class=\"language-text\">GetMapping</code>어노테이션은 꼭 주석처리를 하자.</li>\n<li><code class=\"language-text\">@CookieValue</code>를 사용하면 편리하게 쿠키를 조회 할 수 있다.</li>\n<li>로그인 하지 않은 사용자도 홈에 접근할 수 있기 때문에 <code class=\"language-text\">required=false</code>로 해주어야 한다.</li>\n</ul>\n<h3 id=\"로직-분석\" style=\"position:relative;\"><a href=\"#%EB%A1%9C%EC%A7%81-%EB%B6%84%EC%84%9D\" aria-label=\"로직 분석 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>로직 분석</h3>\n<ul>\n<li>로그인 쿠키(memberId)가 없는 사용자는 home()으로 보내며, 추가로 로그인 쿠키가 있어도 회원이 없다면, home으로 보낸다.</li>\n<li>로그인 쿠키(memberId)가 있는 사용자는 로그인 사용자 전용 홈 화면인 <code class=\"language-text\">loginHome</code>으로 보낸다. 추가적으로 홈화면에 회원 관련 정보도 출력해 주어야 하기 때문에 member데이터도 모델에 담아서 전달한다.</li>\n</ul>\n<ol start=\"2\">\n<li>home.html - 로그인 사용자 전용</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span> <span class=\"token attr-name\"><span class=\"token namespace\">xmlns:</span>th</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://www.thymeleaf.org<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>meta</span> <span class=\"token attr-name\">charset</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>utf-8<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\"><span class=\"token namespace\">th:</span>href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@{/css/bootstrap.min.css}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>../css/bootstrap.min.css<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span> <span class=\"token special-attr\"><span class=\"token attr-name\">style</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span><span class=\"token value css language-css\"><span class=\"token property\">max-width</span><span class=\"token punctuation\">:</span> 600px</span><span class=\"token punctuation\">\"</span></span></span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>py-5 text-center<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span>홈 화면<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h4</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mb-3<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\"><span class=\"token namespace\">th:</span>text</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>|로그인:${member.name}|<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>로그인 사용자 이름<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h4</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>my-4<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>row<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>col<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span>\n            <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>w-100 btn btn-secondary btn-lg<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button<span class=\"token punctuation\">\"</span></span>\n            <span class=\"token attr-name\"><span class=\"token namespace\">th:</span>onclick</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>|location.href=<span class=\"token punctuation\">'</span>@{/items}<span class=\"token punctuation\">'</span>|<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token punctuation\">></span></span>\n            상품 관리\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>col<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\"><span class=\"token namespace\">th:</span>action</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>@{/logout}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>post<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>w-100 btn btn-dark btn-lg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>로그아웃<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>hr</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>my-4<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token comment\">&lt;!-- /container --></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<ul>\n<li><code class=\"language-text\">th:text=\"|로그인:${member.name}|\"</code>는 로그인에 성공한 사용자의 이름을 출력하게끔 셋팅해놓았다.</li>\n<li>상품관리 그리고 로그아웃 버튼을 노출시키게 되어있다.</li>\n</ul>\n<h3 id=\"실행-1\" style=\"position:relative;\"><a href=\"#%EC%8B%A4%ED%96%89-1\" aria-label=\"실행 1 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>실행</h3>\n<ul>\n<li>로그인에 성공하면 사용자 이름이 출력되고, 상품 관리 그리고 로그아웃 버튼을 확인 할 수 있다.</li>\n<li>로그인에 성공 시 세션 쿠키를 확인해 보자. 세션 쿠키는 브라우저를 닫기 전까지 지속적으로 유지가 되며, 웹 브라우저에서 서버에 요청시 <code class=\"language-text\">memberId</code>라는 쿠키의 정보를 계속 보내준다.</li>\n</ul>\n<h2 id=\"-로그아웃-기능-만들기\" style=\"position:relative;\"><a href=\"#-%EB%A1%9C%EA%B7%B8%EC%95%84%EC%9B%83-%EA%B8%B0%EB%8A%A5-%EB%A7%8C%EB%93%A4%EA%B8%B0\" aria-label=\" 로그아웃 기능 만들기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌈 로그아웃 기능 만들기</h2>\n<ul>\n<li>이번에는 로그아웃 기능을 만들어 보자! 다음과 같은 방법으로 진행할예정이다.\n<ol>\n<li>세션 쿠키라는 녀석은 웹 브라우저 종료시 로그아웃이 가능하다.</li>\n<li>혹은 서버에서 해당 쿠키의 종료 날짜를 0으로 지정을 해주면 된다. (즉, 로그아웃 버튼을 클릭시 해당 로직이 실행되게 만들어주면 된다.)</li>\n</ol>\n</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"java\"><pre class=\"language-java\"><code class=\"language-java\"><span class=\"token comment\">//LoginContoller에 logout기능을 추가해보자.</span>\n<span class=\"token annotation punctuation\">@PostMapping</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/logout\"</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">public</span> <span class=\"token class-name\">String</span> <span class=\"token function\">logout</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">expireCookie</span><span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">,</span> <span class=\"token string\">\"memberId\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> <span class=\"token string\">\"redirect:/\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">private</span> <span class=\"token keyword\">void</span> <span class=\"token function\">expireCookie</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HttpServletResponse</span> response<span class=\"token punctuation\">,</span> <span class=\"token class-name\">String</span> cookieName<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token class-name\">Cookie</span> cookie <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Cookie</span><span class=\"token punctuation\">(</span>cookieName<span class=\"token punctuation\">,</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      cookie<span class=\"token punctuation\">.</span><span class=\"token function\">setMaxAge</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      response<span class=\"token punctuation\">.</span><span class=\"token function\">addCookie</span><span class=\"token punctuation\">(</span>cookie<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<ul>\n<li>\n<h3 id=\"위의-컨트롤러-코드에서-눈여겨-볼-것은-code-classlanguage-textexpriecookiecode메소드다-code-classlanguage-textcookienamecode인자값을-전달받고-쿠키를-생성함과-동시에code-classlanguage-textsetmaxagecode메소드에-0이라는-숫자를-적어주었다\" style=\"position:relative;\"><a href=\"#%EC%9C%84%EC%9D%98-%EC%BB%A8%ED%8A%B8%EB%A1%A4%EB%9F%AC-%EC%BD%94%EB%93%9C%EC%97%90%EC%84%9C-%EB%88%88%EC%97%AC%EA%B2%A8-%EB%B3%BC-%EA%B2%83%EC%9D%80-code-classlanguage-textexpriecookiecode%EB%A9%94%EC%86%8C%EB%93%9C%EB%8B%A4-code-classlanguage-textcookienamecode%EC%9D%B8%EC%9E%90%EA%B0%92%EC%9D%84-%EC%A0%84%EB%8B%AC%EB%B0%9B%EA%B3%A0-%EC%BF%A0%ED%82%A4%EB%A5%BC-%EC%83%9D%EC%84%B1%ED%95%A8%EA%B3%BC-%EB%8F%99%EC%8B%9C%EC%97%90code-classlanguage-textsetmaxagecode%EB%A9%94%EC%86%8C%EB%93%9C%EC%97%90-0%EC%9D%B4%EB%9D%BC%EB%8A%94-%EC%88%AB%EC%9E%90%EB%A5%BC-%EC%A0%81%EC%96%B4%EC%A3%BC%EC%97%88%EB%8B%A4\" aria-label=\"위의 컨트롤러 코드에서 눈여겨 볼 것은 code classlanguage textexpriecookiecode메소드다 code classlanguage textcookienamecode인자값을 전달받고 쿠키를 생성함과 동시에code classlanguage textsetmaxagecode메소드에 0이라는 숫자를 적어주었다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>위의 컨트롤러 코드에서 눈여겨 볼 것은 <code class=\"language-text\">exprieCookie()</code>메소드다. <code class=\"language-text\">cookieName</code>인자값을 전달받고 쿠키를 생성함과 동시에<code class=\"language-text\">setMaxAge()</code>메소드에 0이라는 숫자를 적어주었다.</h3>\n</li>\n<li>이렇게 생성 후 시간을 지정해주면 쿠키의 시간이 0이므로 웹 브라우저에서는 <em>쿠키가 삭제</em> 된다.</li>\n</ul>\n<h2 id=\"-쿠키의-보안-문제\" style=\"position:relative;\"><a href=\"#-%EC%BF%A0%ED%82%A4%EC%9D%98-%EB%B3%B4%EC%95%88-%EB%AC%B8%EC%A0%9C\" aria-label=\" 쿠키의 보안 문제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🌂 쿠키의 보안 문제</h2>\n<ul>\n<li>위와 같은 코드로만 로직을 구성하면 너무나 큰 단점이 있다. 그것은 바로 보안 문제이다.</li>\n<li>쿠키에 직접적으로 <code class=\"language-text\">memberId=1, ...10</code>이런식으로 구성이 되어있다면 누구나 손쉽게 데이터를 임의로 조작하여 정보를 빼내어 악용할 가능성이 있다.</li>\n</ul>\n<h3 id=\"보안-문제\" style=\"position:relative;\"><a href=\"#%EB%B3%B4%EC%95%88-%EB%AC%B8%EC%A0%9C\" aria-label=\"보안 문제 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>보안 문제</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">* 쿠키 값은 임의로 변경 할 수 있다.\n  - 클라이언트가 쿠키를 강제로 변경하면 다른 사용자가 된다.\n  - 예를들어 크롬창에서 쿠키에 직접값을 입력하면 다른사용자가 되는것을 볼 수 있다 `개발자 모드 -> Application -> Cookie`에서 `memberId=1 => memberId=2` 이런식으로 말이다.\n* 쿠키에 보관된 정보는 훔칠 수 있다.\n  - 만약 쿠키에 개인정보나, 신용카드 정보가 있다?라고 생각하면 아찔하다.\n  - 이 정보가 웹브라우저에 그대로 노출이 되고, 보관되어 있는 상태인데 네트워크 요청시마다 계~~속 클라이언트에서 서버로 전달된다.\n  - 쿠키의 정보가 나의 로컬PC에서 털리는 일도 일어날 수 있고, 네트워크 전송중 특정 구간에서도 털리는 일이 일어난다.\n* 만약 해커가 나쁜맘을 먹고 쿠키를 훔친다면 ?\n  - 해커가 쿠키를 훔치고 그 쿠키의 정보를 가지고 훔쳐간다면 그 쿠키로 악의적인 요청을 계속 시도할것이다. ex) 신용카드 도용 -> 온라인 결재</code></pre></div>\n<h3 id=\"대안-방법\" style=\"position:relative;\"><a href=\"#%EB%8C%80%EC%95%88-%EB%B0%A9%EB%B2%95\" aria-label=\"대안 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>대안 방법</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">* 쿠키에 중요한 값을 노출하지 않고, 사용자 별로 예측이 불가능한 임의의 토큰(랜덤한 값)을 노출시키고, 서버에서는 토큰과 사용자의 id를 매핑하여 인식하게 해주고, 토큰은 서버가 관리하게끔 설계를 하는것이다.\n* 토큰은 해커가 임의의 값을 넣어도 찾을 수 없도록 예측이 불가능해야 한다.\n* 만에하나 해커가 토큰을 털어간다 가정해도, 시간이 지나면 사용이 불가능 하도록 서버에서 해당 토큰의 만료 시간을 짧게(30분정도로) 유지시킨다. 혹은 해킹이 의심되는 경우 서버에서 해당 토큰을 강제로 제거하게 하면 해결이 가능할 것이다.</code></pre></div>\n<h2 id=\"-앞으로-할-일\" style=\"position:relative;\"><a href=\"#-%EC%95%9E%EC%9C%BC%EB%A1%9C-%ED%95%A0-%EC%9D%BC\" aria-label=\" 앞으로 할 일 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>🎄 앞으로 할 일</h2>\n<ul>\n<li>보안 문제와 대안 방법은 전부 나와있다. 이제 해당 로직을 수행할 서비스만 설계를 하면 보안 문제는 해결이 될것이다.</li>\n<li>그렇다면 목표를 다시 한번 확인해 보고 추후 진행 될 방법을 알아 보도록 하자.</li>\n</ul>\n<h3 id=\"로그인-처리하기---세션동작방식\" style=\"position:relative;\"><a href=\"#%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EC%B2%98%EB%A6%AC%ED%95%98%EA%B8%B0---%EC%84%B8%EC%85%98%EB%8F%99%EC%9E%91%EB%B0%A9%EC%8B%9D\" aria-label=\"로그인 처리하기   세션동작방식 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>로그인 처리하기 - 세션동작방식</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">* 목표\n  - 앞서 쿠키에 중요한 정보를 보관하는 방법은 여러가지의 보안적인 문제,이슈가 있었다. 이 문제를 해결하려면 결국 중요한 정보는 서버가 들고있고, 저장역시 서버에 해야한다는것이다.\n  - 또한 클라이언트와 서버는 예측이 불가한 임의의 식별자 값으로 서로 커넥팅이 가능해야 한다는 뜻이다.\n  - 이렇게 서버에 중요한 정보를 보관하고 연결을 유지하는 방법은 세션이라 한다.</code></pre></div>\n<p><strong>to be continue…(세션 동작 방식)</strong></p>","frontmatter":{"date":"December 07, 2023","title":"SpringBoot의 로그인 처리 쿠키와 세션(part.4 세션 쿠키 활용)","categories":"SpringBoot","author":"아구","emoji":"🪼"},"fields":{"slug":"/springbootCookieAndSession(part.4)/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://leesungki.github.io","comments":{"utterances":{"repo":"LeeSungKi/leesungki.github.io"}}}}},"pageContext":{"slug":"/springbootCookieAndSession(part.5)/","nextSlug":"/springbootCookieAndSession(part.4)/","prevSlug":""}},
    "staticQueryHashes": ["1073350324","1956554647","2938748437"]}